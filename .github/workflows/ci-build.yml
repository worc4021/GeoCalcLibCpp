name: Mex build

on:
  push:
    branches: [ "master" ]
  pull_request:
    branches: [ "master" ]
  workflow_dispatch:

jobs:
  windows:
    runs-on: windows-latest
    steps:
    - uses: actions/checkout@v4
    - name: Install Matlab
      run: |
        Invoke-WebRequest -Uri https://www.mathworks.com/mpm/win64/mpm -OutFile mpm.exe -Verbose
        .\mpm.exe install  --release R2019b --products MATLAB
      working-directory: ${{ runner.temp }}
    - name: Configure
      run: |
        cmake --preset windows-msvc-release-config
      working-directory: ${{ github.workspace }}
    - name: Build
      run: |
        cmake --build --preset windows-msvc-release-build
      working-directory: ${{ github.workspace }}